{% extends 'base.html' %}

{% block content %}

<h1>On Comparisons page</h1>

<button id="createComparisonButton" type="button" class="btn btn-primary">Create</button>

<div class="comparisons">
    {% for comparison in comparisons %}

    <div class="comparison" id="{{comparison._id}}">
        <span data-test="comparison-name">{{comparison.name}} - {{comparison.timestamp}}</span>
        <input type="button" data-test="view-comparison-details" class="view-comparison btn btn-md btn-light"
            value="View" onclick="viewComparison(this.closest('div').id)">
        <input type="button" class="delete-comparison-button btn btn-md btn-light" onclick="deleteComparison(this)"
            value="Delete">
    </div>

    {% endfor %}
</div>

<script type="text/javascript">
    document.getElementById("createComparisonButton").onclick = () => location.href = '{{url_for("new_comparison")}}'

    function viewComparison(comparison_id) {
        location.href = `/comparisons/${comparison_id}`
    }

    function deleteComparisonFromDatabase(comparison_id) {
        fetch(`/comparisons/${comparison_id}`, { method: 'delete' })
    }

    function deleteComparison(event) {
        {
            const parent_div = event.closest("div")
            deleteComparisonFromDatabase(parent_div.id)
            parent_div.remove()
        }
    }

</script>


{% endblock content %}